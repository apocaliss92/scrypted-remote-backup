(()=>{var e={7562:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.sdk=t.MixinDeviceBase=t.ScryptedDeviceBase=void 0,o(r(4192),t);const i=r(4192);class s extends i.DeviceBase{constructor(e){super(),this.nativeId=e}get storage(){return this._storage||(this._storage=deviceManager.getDeviceStorage(this.nativeId)),this._storage}get log(){return this._log||(this._log=deviceManager.getDeviceLogger(this.nativeId)),this._log}get console(){return this._console||(this._console=deviceManager.getDeviceConsole(this.nativeId)),this._console}async createMediaObject(e,t){return mediaManager.createMediaObject(e,t,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:deviceManager.getMixinConsole(e.sourceId,this.nativeId)}_lazyLoadDeviceState(){this._deviceState||(this.nativeId?this._deviceState=deviceManager.getDeviceState(this.nativeId):this._deviceState=deviceManager.getDeviceState())}onDeviceEvent(e,t){return deviceManager.onDeviceEvent(this.nativeId,e,t)}}t.ScryptedDeviceBase=s;class a extends i.DeviceBase{constructor(e){super(),this._listeners=new Set,this.mixinDevice=e.mixinDevice,this.mixinDeviceInterfaces=e.mixinDeviceInterfaces,this.mixinStorageSuffix=e.mixinStorageSuffix,this._deviceState=e.mixinDeviceState,this.nativeId=systemManager.getDeviceById(this.id).nativeId,this.mixinProviderNativeId=e.mixinProviderNativeId,this._deviceState.__rpcproxy_traps_all_properties&&"string"==typeof this._deviceState.id&&(this._deviceState=deviceManager.createDeviceState(this._deviceState.id,this._deviceState.setState))}get storage(){if(!this._storage){const e=this.mixinStorageSuffix,t=this.id+(e?":"+e:"");this._storage=deviceManager.getMixinStorage(t,this.mixinProviderNativeId)}return this._storage}get console(){return this._console||(deviceManager.getMixinConsole?this._console=deviceManager.getMixinConsole(this.id,this.mixinProviderNativeId):this._console=deviceManager.getDeviceConsole(this.mixinProviderNativeId)),this._console}async createMediaObject(e,t){return mediaManager.createMediaObject(e,t,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:deviceManager.getMixinConsole(e.sourceId,this.mixinProviderNativeId)}onDeviceEvent(e,t){return deviceManager.onMixinEvent(this.id,this,e,t)}_lazyLoadDeviceState(){}manageListener(e){this._listeners.add(e)}release(){for(const e of this._listeners)e.removeListener()}}t.MixinDeviceBase=a,function(){function e(e){return function(){return this._lazyLoadDeviceState(),this._deviceState?.[e]}}function t(e){return function(t){this._lazyLoadDeviceState(),this._deviceState?this._deviceState[e]=t:console.warn("device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.")}}for(const r of Object.values(i.ScryptedInterfaceProperty))r!==i.ScryptedInterfaceProperty.nativeId&&(Object.defineProperty(s.prototype,r,{set:t(r),get:e(r)}),Object.defineProperty(a.prototype,r,{set:t(r),get:e(r)}))}(),t.sdk={};try{let e;try{e=pluginRuntimeAPI}catch(e){}Object.assign(t.sdk,{log:deviceManager.getDeviceLogger(void 0),deviceManager,endpointManager,mediaManager,systemManager,pluginHostAPI,...e});try{systemManager.setScryptedInterfaceDescriptors?.(i.TYPES_VERSION,i.ScryptedInterfaceDescriptors)?.catch((()=>{}))}catch(e){}}catch(e){console.error("sdk initialization error, import @scrypted/types or use @scrypted/client instead",e)}t.default=t.sdk},6117:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageSettings=void 0;const s=i(r(7562)),{systemManager:a}=s.default;t.StorageSettings=class{constructor(e,t){this.device=e,this.settings=t,this.values={},this.hasValue={};for(const e of Object.keys(t)){const r=t[e],n=()=>this.getItem(e);let o;o="clippath"!==r.type?n:()=>{try{return JSON.parse(n())}catch(e){}},Object.defineProperty(this.values,e,{get:o,set:t=>this.putSetting(e,t),enumerable:!0}),Object.defineProperty(this.hasValue,e,{get:()=>null!=this.device.storage.getItem(e),enumerable:!0})}}get keys(){const e={};for(const t of Object.keys(this.settings))e[t]=t;return e}async getSettings(){const e=await(this.options?.onGet?.()),t=[];for(const[r,n]of Object.entries(this.settings)){let o=Object.assign({},n);e?.[r]&&(o=Object.assign(o,e[r])),o.onGet&&(o=Object.assign(o,await o.onGet())),o.hide||await(this.options?.hide?.[r]?.())||(o.key=r,o.value=this.getItemInternal(r,o,!0),t.push(o),delete o.onPut,delete o.onGet,delete o.mapPut,delete o.mapGet)}return t}async putSetting(e,t){const r=this.settings[e];let n;return r&&(n=this.getItemInternal(e,r)),this.putSettingInternal(r,n,e,t)}putSettingInternal(e,t,r,n){e?.noStore||(e?.mapPut&&(n=e.mapPut(t,n)),null==n?this.device.storage.removeItem(r):"object"==typeof n?this.device.storage.setItem(r,JSON.stringify(n)):this.device.storage.setItem(r,n?.toString())),e?.onPut?.(t,n),e?.hide||this.device.onDeviceEvent(s.ScryptedInterface.Settings,void 0)}getItemInternal(e,t,r){if(!t)return this.device.storage.getItem(e);const n=function(e,t,r,n){if(null==e)return r();const o=t.multiple?"array":t.type;if("boolean"===o)return"true"===e||"false"!==e&&(r()||!1);if("number"===o){const t=parseFloat(e);return isNaN(t)?r()||0:t}if("integer"===o){const t=parseInt(e);return isNaN(t)?r()||0:t}if("array"===o){if(!e)return r()||[];try{return JSON.parse(e)}catch(e){return r()||[]}}if("device"===o)return n?e:a.getDeviceById(e)||a.getDeviceById(r());if(e&&t.json)try{return JSON.parse(e)}catch(e){return r()}return e||r()}(this.device.storage.getItem(e),t,(()=>null!=t.persistedDefaultValue?(this.putSettingInternal(t,void 0,e,t.persistedDefaultValue),t.persistedDefaultValue):t.defaultValue),r);return t.mapGet?t.mapGet(n):n}getItem(e){return this.getItemInternal(e,this.settings[e])}}},4192:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScryptedMimeTypes=t.ScryptedInterface=t.MediaPlayerState=t.SecuritySystemObstruction=t.SecuritySystemMode=t.AirQuality=t.AirPurifierMode=t.AirPurifierStatus=t.ChargeState=t.LockState=t.PanTiltZoomMovement=t.ThermostatMode=t.TemperatureUnit=t.FanMode=t.HumidityMode=t.ScryptedDeviceType=t.ScryptedInterfaceDescriptors=t.ScryptedInterfaceMethod=t.ScryptedInterfaceProperty=t.DeviceBase=t.TYPES_VERSION=void 0,t.TYPES_VERSION="0.3.59";var r,n,o,i,s,a,c,u,d,p,l,m,f,h,g,v,y,S;t.DeviceBase=class{},function(e){e.id="id",e.info="info",e.interfaces="interfaces",e.mixins="mixins",e.name="name",e.nativeId="nativeId",e.pluginId="pluginId",e.providedInterfaces="providedInterfaces",e.providedName="providedName",e.providedRoom="providedRoom",e.providedType="providedType",e.providerId="providerId",e.room="room",e.type="type",e.scryptedRuntimeArguments="scryptedRuntimeArguments",e.on="on",e.brightness="brightness",e.colorTemperature="colorTemperature",e.rgb="rgb",e.hsv="hsv",e.running="running",e.paused="paused",e.docked="docked",e.temperatureSetting="temperatureSetting",e.temperature="temperature",e.temperatureUnit="temperatureUnit",e.humidity="humidity",e.audioVolumes="audioVolumes",e.recordingActive="recordingActive",e.ptzCapabilities="ptzCapabilities",e.lockState="lockState",e.entryOpen="entryOpen",e.batteryLevel="batteryLevel",e.chargeState="chargeState",e.online="online",e.fromMimeType="fromMimeType",e.toMimeType="toMimeType",e.converters="converters",e.binaryState="binaryState",e.tampered="tampered",e.powerDetected="powerDetected",e.audioDetected="audioDetected",e.motionDetected="motionDetected",e.ambientLight="ambientLight",e.occupied="occupied",e.flooded="flooded",e.ultraviolet="ultraviolet",e.luminance="luminance",e.position="position",e.securitySystemState="securitySystemState",e.pm10Density="pm10Density",e.pm25Density="pm25Density",e.vocDensity="vocDensity",e.noxDensity="noxDensity",e.co2ppm="co2ppm",e.airQuality="airQuality",e.airPurifierState="airPurifierState",e.filterChangeIndication="filterChangeIndication",e.filterLifeLevel="filterLifeLevel",e.humiditySetting="humiditySetting",e.fan="fan",e.applicationInfo="applicationInfo",e.systemDevice="systemDevice"}(r||(t.ScryptedInterfaceProperty=r={})),function(e){e.listen="listen",e.probe="probe",e.setMixins="setMixins",e.setName="setName",e.setRoom="setRoom",e.setType="setType",e.getPluginJson="getPluginJson",e.turnOff="turnOff",e.turnOn="turnOn",e.setBrightness="setBrightness",e.getTemperatureMaxK="getTemperatureMaxK",e.getTemperatureMinK="getTemperatureMinK",e.setColorTemperature="setColorTemperature",e.setRgb="setRgb",e.setHsv="setHsv",e.sendNotification="sendNotification",e.start="start",e.stop="stop",e.pause="pause",e.resume="resume",e.dock="dock",e.setTemperature="setTemperature",e.setTemperatureUnit="setTemperatureUnit",e.getPictureOptions="getPictureOptions",e.takePicture="takePicture",e.getAudioStream="getAudioStream",e.setAudioVolumes="setAudioVolumes",e.startDisplay="startDisplay",e.stopDisplay="stopDisplay",e.getVideoStream="getVideoStream",e.getVideoStreamOptions="getVideoStreamOptions",e.getPrivacyMasks="getPrivacyMasks",e.setPrivacyMasks="setPrivacyMasks",e.getRecordingStream="getRecordingStream",e.getRecordingStreamCurrentTime="getRecordingStreamCurrentTime",e.getRecordingStreamOptions="getRecordingStreamOptions",e.getRecordingStreamThumbnail="getRecordingStreamThumbnail",e.deleteRecordingStream="deleteRecordingStream",e.setRecordingActive="setRecordingActive",e.ptzCommand="ptzCommand",e.getRecordedEvents="getRecordedEvents",e.getVideoClip="getVideoClip",e.getVideoClipThumbnail="getVideoClipThumbnail",e.getVideoClips="getVideoClips",e.removeVideoClips="removeVideoClips",e.setVideoStreamOptions="setVideoStreamOptions",e.startIntercom="startIntercom",e.stopIntercom="stopIntercom",e.lock="lock",e.unlock="unlock",e.addPassword="addPassword",e.getPasswords="getPasswords",e.removePassword="removePassword",e.activate="activate",e.deactivate="deactivate",e.isReversible="isReversible",e.closeEntry="closeEntry",e.openEntry="openEntry",e.getDevice="getDevice",e.releaseDevice="releaseDevice",e.adoptDevice="adoptDevice",e.discoverDevices="discoverDevices",e.createDevice="createDevice",e.getCreateDeviceSettings="getCreateDeviceSettings",e.reboot="reboot",e.getRefreshFrequency="getRefreshFrequency",e.refresh="refresh",e.getMediaStatus="getMediaStatus",e.load="load",e.seek="seek",e.skipNext="skipNext",e.skipPrevious="skipPrevious",e.convert="convert",e.convertMedia="convertMedia",e.getSettings="getSettings",e.putSetting="putSetting",e.armSecuritySystem="armSecuritySystem",e.disarmSecuritySystem="disarmSecuritySystem",e.setAirPurifierState="setAirPurifierState",e.getReadmeMarkdown="getReadmeMarkdown",e.getOauthUrl="getOauthUrl",e.onOauthCallback="onOauthCallback",e.canMixin="canMixin",e.getMixin="getMixin",e.releaseMixin="releaseMixin",e.onRequest="onRequest",e.onConnection="onConnection",e.onPush="onPush",e.run="run",e.eval="eval",e.loadScripts="loadScripts",e.saveScript="saveScript",e.trackObjects="trackObjects",e.getDetectionInput="getDetectionInput",e.getObjectTypes="getObjectTypes",e.detectObjects="detectObjects",e.generateObjectDetections="generateObjectDetections",e.getDetectionModel="getDetectionModel",e.setHumidity="setHumidity",e.setFan="setFan",e.startRTCSignalingSession="startRTCSignalingSession",e.createRTCSignalingSession="createRTCSignalingSession",e.getScryptedUserAccessControl="getScryptedUserAccessControl",e.generateVideoFrames="generateVideoFrames",e.connectStream="connectStream",e.getTTYSettings="getTTYSettings"}(n||(t.ScryptedInterfaceMethod=n={})),t.ScryptedInterfaceDescriptors={ScryptedDevice:{name:"ScryptedDevice",methods:["listen","probe","setMixins","setName","setRoom","setType"],properties:["id","info","interfaces","mixins","name","nativeId","pluginId","providedInterfaces","providedName","providedRoom","providedType","providerId","room","type"]},ScryptedPlugin:{name:"ScryptedPlugin",methods:["getPluginJson"],properties:[]},ScryptedPluginRuntime:{name:"ScryptedPluginRuntime",methods:[],properties:["scryptedRuntimeArguments"]},OnOff:{name:"OnOff",methods:["turnOff","turnOn"],properties:["on"]},Brightness:{name:"Brightness",methods:["setBrightness"],properties:["brightness"]},ColorSettingTemperature:{name:"ColorSettingTemperature",methods:["getTemperatureMaxK","getTemperatureMinK","setColorTemperature"],properties:["colorTemperature"]},ColorSettingRgb:{name:"ColorSettingRgb",methods:["setRgb"],properties:["rgb"]},ColorSettingHsv:{name:"ColorSettingHsv",methods:["setHsv"],properties:["hsv"]},Notifier:{name:"Notifier",methods:["sendNotification"],properties:[]},StartStop:{name:"StartStop",methods:["start","stop"],properties:["running"]},Pause:{name:"Pause",methods:["pause","resume"],properties:["paused"]},Dock:{name:"Dock",methods:["dock"],properties:["docked"]},TemperatureSetting:{name:"TemperatureSetting",methods:["setTemperature"],properties:["temperatureSetting"]},Thermometer:{name:"Thermometer",methods:["setTemperatureUnit"],properties:["temperature","temperatureUnit"]},HumiditySensor:{name:"HumiditySensor",methods:[],properties:["humidity"]},Camera:{name:"Camera",methods:["getPictureOptions","takePicture"],properties:[]},Microphone:{name:"Microphone",methods:["getAudioStream"],properties:[]},AudioVolumeControl:{name:"AudioVolumeControl",methods:["setAudioVolumes"],properties:["audioVolumes"]},Display:{name:"Display",methods:["startDisplay","stopDisplay"],properties:[]},VideoCamera:{name:"VideoCamera",methods:["getVideoStream","getVideoStreamOptions"],properties:[]},VideoCameraMask:{name:"VideoCameraMask",methods:["getPrivacyMasks","setPrivacyMasks"],properties:[]},VideoRecorder:{name:"VideoRecorder",methods:["getRecordingStream","getRecordingStreamCurrentTime","getRecordingStreamOptions","getRecordingStreamThumbnail"],properties:["recordingActive"]},VideoRecorderManagement:{name:"VideoRecorderManagement",methods:["deleteRecordingStream","setRecordingActive"],properties:[]},PanTiltZoom:{name:"PanTiltZoom",methods:["ptzCommand"],properties:["ptzCapabilities"]},EventRecorder:{name:"EventRecorder",methods:["getRecordedEvents"],properties:[]},VideoClips:{name:"VideoClips",methods:["getVideoClip","getVideoClipThumbnail","getVideoClips","removeVideoClips"],properties:[]},VideoCameraConfiguration:{name:"VideoCameraConfiguration",methods:["setVideoStreamOptions"],properties:[]},Intercom:{name:"Intercom",methods:["startIntercom","stopIntercom"],properties:[]},Lock:{name:"Lock",methods:["lock","unlock"],properties:["lockState"]},PasswordStore:{name:"PasswordStore",methods:["addPassword","getPasswords","removePassword"],properties:[]},Scene:{name:"Scene",methods:["activate","deactivate","isReversible"],properties:[]},Entry:{name:"Entry",methods:["closeEntry","openEntry"],properties:[]},EntrySensor:{name:"EntrySensor",methods:[],properties:["entryOpen"]},DeviceProvider:{name:"DeviceProvider",methods:["getDevice","releaseDevice"],properties:[]},DeviceDiscovery:{name:"DeviceDiscovery",methods:["adoptDevice","discoverDevices"],properties:[]},DeviceCreator:{name:"DeviceCreator",methods:["createDevice","getCreateDeviceSettings"],properties:[]},Battery:{name:"Battery",methods:[],properties:["batteryLevel"]},Charger:{name:"Charger",methods:[],properties:["chargeState"]},Reboot:{name:"Reboot",methods:["reboot"],properties:[]},Refresh:{name:"Refresh",methods:["getRefreshFrequency","refresh"],properties:[]},MediaPlayer:{name:"MediaPlayer",methods:["getMediaStatus","load","seek","skipNext","skipPrevious"],properties:[]},Online:{name:"Online",methods:[],properties:["online"]},BufferConverter:{name:"BufferConverter",methods:["convert"],properties:["fromMimeType","toMimeType"]},MediaConverter:{name:"MediaConverter",methods:["convertMedia"],properties:["converters"]},Settings:{name:"Settings",methods:["getSettings","putSetting"],properties:[]},BinarySensor:{name:"BinarySensor",methods:[],properties:["binaryState"]},TamperSensor:{name:"TamperSensor",methods:[],properties:["tampered"]},PowerSensor:{name:"PowerSensor",methods:[],properties:["powerDetected"]},AudioSensor:{name:"AudioSensor",methods:[],properties:["audioDetected"]},MotionSensor:{name:"MotionSensor",methods:[],properties:["motionDetected"]},AmbientLightSensor:{name:"AmbientLightSensor",methods:[],properties:["ambientLight"]},OccupancySensor:{name:"OccupancySensor",methods:[],properties:["occupied"]},FloodSensor:{name:"FloodSensor",methods:[],properties:["flooded"]},UltravioletSensor:{name:"UltravioletSensor",methods:[],properties:["ultraviolet"]},LuminanceSensor:{name:"LuminanceSensor",methods:[],properties:["luminance"]},PositionSensor:{name:"PositionSensor",methods:[],properties:["position"]},SecuritySystem:{name:"SecuritySystem",methods:["armSecuritySystem","disarmSecuritySystem"],properties:["securitySystemState"]},PM10Sensor:{name:"PM10Sensor",methods:[],properties:["pm10Density"]},PM25Sensor:{name:"PM25Sensor",methods:[],properties:["pm25Density"]},VOCSensor:{name:"VOCSensor",methods:[],properties:["vocDensity"]},NOXSensor:{name:"NOXSensor",methods:[],properties:["noxDensity"]},CO2Sensor:{name:"CO2Sensor",methods:[],properties:["co2ppm"]},AirQualitySensor:{name:"AirQualitySensor",methods:[],properties:["airQuality"]},AirPurifier:{name:"AirPurifier",methods:["setAirPurifierState"],properties:["airPurifierState"]},FilterMaintenance:{name:"FilterMaintenance",methods:[],properties:["filterChangeIndication","filterLifeLevel"]},Readme:{name:"Readme",methods:["getReadmeMarkdown"],properties:[]},OauthClient:{name:"OauthClient",methods:["getOauthUrl","onOauthCallback"],properties:[]},MixinProvider:{name:"MixinProvider",methods:["canMixin","getMixin","releaseMixin"],properties:[]},HttpRequestHandler:{name:"HttpRequestHandler",methods:["onRequest"],properties:[]},EngineIOHandler:{name:"EngineIOHandler",methods:["onConnection"],properties:[]},PushHandler:{name:"PushHandler",methods:["onPush"],properties:[]},Program:{name:"Program",methods:["run"],properties:[]},Scriptable:{name:"Scriptable",methods:["eval","loadScripts","saveScript"],properties:[]},ObjectTracker:{name:"ObjectTracker",methods:["trackObjects"],properties:[]},ObjectDetector:{name:"ObjectDetector",methods:["getDetectionInput","getObjectTypes"],properties:[]},ObjectDetection:{name:"ObjectDetection",methods:["detectObjects","generateObjectDetections","getDetectionModel"],properties:[]},ObjectDetectionPreview:{name:"ObjectDetectionPreview",methods:[],properties:[]},ObjectDetectionGenerator:{name:"ObjectDetectionGenerator",methods:[],properties:[]},HumiditySetting:{name:"HumiditySetting",methods:["setHumidity"],properties:["humiditySetting"]},Fan:{name:"Fan",methods:["setFan"],properties:["fan"]},RTCSignalingChannel:{name:"RTCSignalingChannel",methods:["startRTCSignalingSession"],properties:[]},RTCSignalingClient:{name:"RTCSignalingClient",methods:["createRTCSignalingSession"],properties:[]},LauncherApplication:{name:"LauncherApplication",methods:[],properties:["applicationInfo"]},ScryptedUser:{name:"ScryptedUser",methods:["getScryptedUserAccessControl"],properties:[]},VideoFrameGenerator:{name:"VideoFrameGenerator",methods:["generateVideoFrames"],properties:[]},StreamService:{name:"StreamService",methods:["connectStream"],properties:[]},TTY:{name:"TTY",methods:[],properties:[]},TTYSettings:{name:"TTYSettings",methods:["getTTYSettings"],properties:[]},ScryptedSystemDevice:{name:"ScryptedSystemDevice",methods:[],properties:["systemDevice"]},ScryptedDeviceCreator:{name:"ScryptedDeviceCreator",methods:[],properties:[]},ScryptedSettings:{name:"ScryptedSettings",methods:[],properties:[]}},function(e){e.Builtin="Builtin",e.Camera="Camera",e.Fan="Fan",e.Light="Light",e.Switch="Switch",e.Outlet="Outlet",e.Sensor="Sensor",e.Scene="Scene",e.Program="Program",e.Automation="Automation",e.Vacuum="Vacuum",e.Notifier="Notifier",e.Thermostat="Thermostat",e.Lock="Lock",e.PasswordControl="PasswordControl",e.Display="Display",e.SmartDisplay="SmartDisplay",e.Speaker="Speaker",e.SmartSpeaker="SmartSpeaker",e.Event="Event",e.Entry="Entry",e.Garage="Garage",e.DeviceProvider="DeviceProvider",e.DataSource="DataSource",e.API="API",e.Doorbell="Doorbell",e.Irrigation="Irrigation",e.Valve="Valve",e.Person="Person",e.SecuritySystem="SecuritySystem",e.WindowCovering="WindowCovering",e.Siren="Siren",e.AirPurifier="AirPurifier",e.Unknown="Unknown"}(o||(t.ScryptedDeviceType=o={})),function(e){e.Humidify="Humidify",e.Dehumidify="Dehumidify",e.Auto="Auto",e.Off="Off"}(i||(t.HumidityMode=i={})),function(e){e.Auto="Auto",e.Manual="Manual"}(s||(t.FanMode=s={})),function(e){e.C="C",e.F="F"}(a||(t.TemperatureUnit=a={})),function(e){e.Off="Off",e.Cool="Cool",e.Heat="Heat",e.HeatCool="HeatCool",e.Auto="Auto",e.FanOnly="FanOnly",e.Purifier="Purifier",e.Eco="Eco",e.Dry="Dry",e.On="On"}(c||(t.ThermostatMode=c={})),function(e){e.Absolute="Absolute",e.Relative="Relative",e.Continuous="Continuous",e.Preset="Preset",e.Home="Home"}(u||(t.PanTiltZoomMovement=u={})),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Jammed="Jammed"}(d||(t.LockState=d={})),function(e){e.Trickle="trickle",e.Charging="charging",e.NotCharging="not-charging"}(p||(t.ChargeState=p={})),function(e){e.Inactive="Inactive",e.Idle="Idle",e.Active="Active",e.ActiveNightMode="ActiveNightMode"}(l||(t.AirPurifierStatus=l={})),function(e){e.Manual="Manual",e.Automatic="Automatic"}(m||(t.AirPurifierMode=m={})),function(e){e.Unknown="Unknown",e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Inferior="Inferior",e.Poor="Poor"}(f||(t.AirQuality=f={})),function(e){e.Disarmed="Disarmed",e.HomeArmed="HomeArmed",e.AwayArmed="AwayArmed",e.NightArmed="NightArmed"}(h||(t.SecuritySystemMode=h={})),function(e){e.Sensor="Sensor",e.Occupied="Occupied",e.Time="Time",e.Error="Error"}(g||(t.SecuritySystemObstruction=g={})),function(e){e.Idle="Idle",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering"}(v||(t.MediaPlayerState=v={})),function(e){e.ScryptedDevice="ScryptedDevice",e.ScryptedPlugin="ScryptedPlugin",e.ScryptedPluginRuntime="ScryptedPluginRuntime",e.OnOff="OnOff",e.Brightness="Brightness",e.ColorSettingTemperature="ColorSettingTemperature",e.ColorSettingRgb="ColorSettingRgb",e.ColorSettingHsv="ColorSettingHsv",e.Notifier="Notifier",e.StartStop="StartStop",e.Pause="Pause",e.Dock="Dock",e.TemperatureSetting="TemperatureSetting",e.Thermometer="Thermometer",e.HumiditySensor="HumiditySensor",e.Camera="Camera",e.Microphone="Microphone",e.AudioVolumeControl="AudioVolumeControl",e.Display="Display",e.VideoCamera="VideoCamera",e.VideoCameraMask="VideoCameraMask",e.VideoRecorder="VideoRecorder",e.VideoRecorderManagement="VideoRecorderManagement",e.PanTiltZoom="PanTiltZoom",e.EventRecorder="EventRecorder",e.VideoClips="VideoClips",e.VideoCameraConfiguration="VideoCameraConfiguration",e.Intercom="Intercom",e.Lock="Lock",e.PasswordStore="PasswordStore",e.Scene="Scene",e.Entry="Entry",e.EntrySensor="EntrySensor",e.DeviceProvider="DeviceProvider",e.DeviceDiscovery="DeviceDiscovery",e.DeviceCreator="DeviceCreator",e.Battery="Battery",e.Charger="Charger",e.Reboot="Reboot",e.Refresh="Refresh",e.MediaPlayer="MediaPlayer",e.Online="Online",e.BufferConverter="BufferConverter",e.MediaConverter="MediaConverter",e.Settings="Settings",e.BinarySensor="BinarySensor",e.TamperSensor="TamperSensor",e.PowerSensor="PowerSensor",e.AudioSensor="AudioSensor",e.MotionSensor="MotionSensor",e.AmbientLightSensor="AmbientLightSensor",e.OccupancySensor="OccupancySensor",e.FloodSensor="FloodSensor",e.UltravioletSensor="UltravioletSensor",e.LuminanceSensor="LuminanceSensor",e.PositionSensor="PositionSensor",e.SecuritySystem="SecuritySystem",e.PM10Sensor="PM10Sensor",e.PM25Sensor="PM25Sensor",e.VOCSensor="VOCSensor",e.NOXSensor="NOXSensor",e.CO2Sensor="CO2Sensor",e.AirQualitySensor="AirQualitySensor",e.AirPurifier="AirPurifier",e.FilterMaintenance="FilterMaintenance",e.Readme="Readme",e.OauthClient="OauthClient",e.MixinProvider="MixinProvider",e.HttpRequestHandler="HttpRequestHandler",e.EngineIOHandler="EngineIOHandler",e.PushHandler="PushHandler",e.Program="Program",e.Scriptable="Scriptable",e.ObjectTracker="ObjectTracker",e.ObjectDetector="ObjectDetector",e.ObjectDetection="ObjectDetection",e.ObjectDetectionPreview="ObjectDetectionPreview",e.ObjectDetectionGenerator="ObjectDetectionGenerator",e.HumiditySetting="HumiditySetting",e.Fan="Fan",e.RTCSignalingChannel="RTCSignalingChannel",e.RTCSignalingClient="RTCSignalingClient",e.LauncherApplication="LauncherApplication",e.ScryptedUser="ScryptedUser",e.VideoFrameGenerator="VideoFrameGenerator",e.StreamService="StreamService",e.TTY="TTY",e.TTYSettings="TTYSettings",e.ScryptedSystemDevice="ScryptedSystemDevice",e.ScryptedDeviceCreator="ScryptedDeviceCreator",e.ScryptedSettings="ScryptedSettings"}(y||(t.ScryptedInterface=y={})),function(e){e.Url="text/x-uri",e.InsecureLocalUrl="text/x-insecure-local-uri",e.LocalUrl="text/x-local-uri",e.ServerId="text/x-server-id",e.PushEndpoint="text/x-push-endpoint",e.SchemePrefix="x-scrypted/x-scrypted-scheme-",e.MediaStreamUrl="text/x-media-url",e.MediaObject="x-scrypted/x-scrypted-media-object",e.RequestMediaObject="x-scrypted/x-scrypted-request-media-object",e.RequestMediaStream="x-scrypted/x-scrypted-request-stream",e.MediaStreamFeedback="x-scrypted/x-media-stream-feedback",e.FFmpegInput="x-scrypted/x-ffmpeg-input",e.FFmpegTranscodeStream="x-scrypted/x-ffmpeg-transcode-stream",e.RTCSignalingChannel="x-scrypted/x-scrypted-rtc-signaling-channel",e.RTCSignalingSession="x-scrypted/x-scrypted-rtc-signaling-session",e.RTCConnectionManagement="x-scrypted/x-scrypted-rtc-connection-management",e.Image="x-scrypted/x-scrypted-image"}(S||(t.ScryptedMimeTypes=S={}))},4993:(e,t,r)=>{"use strict";const n=r(5317),o=r(2014),i=r(3436);function s(e,t,r){const s=o(e,t,r),a=n.spawn(s.command,s.args,s.options);return i.hookChildProcess(a,s),a}e.exports=s,e.exports.spawn=s,e.exports.sync=function(e,t,r){const s=o(e,t,r),a=n.spawnSync(s.command,s.args,s.options);return a.error=a.error||i.verifyENOENTSync(a.status,s),a},e.exports._parse=o,e.exports._enoent=i},3436:e=>{"use strict";const t="win32"===process.platform;function r(e,t){return Object.assign(new Error(`${t} ${e.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${t} ${e.command}`,path:e.command,spawnargs:e.args})}function n(e,n){return t&&1===e&&!n.file?r(n.original,"spawn"):null}e.exports={hookChildProcess:function(e,r){if(!t)return;const o=e.emit;e.emit=function(t,i){if("exit"===t){const t=n(i,r);if(t)return o.call(e,"error",t)}return o.apply(e,arguments)}},verifyENOENT:n,verifyENOENTSync:function(e,n){return t&&1===e&&!n.file?r(n.original,"spawnSync"):null},notFoundError:r}},2014:(e,t,r)=>{"use strict";const n=r(6928),o=r(9045),i=r(4483),s=r(9182),a="win32"===process.platform,c=/\.(?:com|exe)$/i,u=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function d(e){if(!a)return e;const t=function(e){e.file=o(e);const t=e.file&&s(e.file);return t?(e.args.unshift(e.file),e.command=t,o(e)):e.file}(e),r=!c.test(t);if(e.options.forceShell||r){const r=u.test(t);e.command=n.normalize(e.command),e.command=i.command(e.command),e.args=e.args.map((e=>i.argument(e,r)));const o=[e.command].concat(e.args).join(" ");e.args=["/d","/s","/c",`"${o}"`],e.command=process.env.comspec||"cmd.exe",e.options.windowsVerbatimArguments=!0}return e}e.exports=function(e,t,r){t&&!Array.isArray(t)&&(r=t,t=null);const n={command:e,args:t=t?t.slice(0):[],options:r=Object.assign({},r),file:void 0,original:{command:e,args:t}};return r.shell?n:d(n)}},4483:e=>{"use strict";const t=/([()\][%!^"`<>&|;, *?])/g;e.exports.command=function(e){return e=e.replace(t,"^$1")},e.exports.argument=function(e,r){return e=(e=`"${e=(e=(e=`${e}`).replace(/(\\*)"/g,'$1$1\\"')).replace(/(\\*)$/,"$1$1")}"`).replace(t,"^$1"),r&&(e=e.replace(t,"^$1")),e}},9182:(e,t,r)=>{"use strict";const n=r(9896),o=r(1395);e.exports=function(e){const t=Buffer.alloc(150);let r;try{r=n.openSync(e,"r"),n.readSync(r,t,0,150,0),n.closeSync(r)}catch(e){}return o(t.toString())}},9045:(e,t,r)=>{"use strict";const n=r(6928),o=r(6911),i=r(9376);function s(e,t){const r=e.options.env||process.env,s=process.cwd(),a=null!=e.options.cwd,c=a&&void 0!==process.chdir&&!process.chdir.disabled;if(c)try{process.chdir(e.options.cwd)}catch(e){}let u;try{u=o.sync(e.command,{path:r[i({env:r})],pathExt:t?n.delimiter:void 0})}catch(e){}finally{c&&process.chdir(s)}return u&&(u=n.resolve(a?e.options.cwd:"",u)),u}e.exports=function(e){return s(e)||s(e,!0)}},2779:(e,t,r)=>{"use strict";const n=r(6928),o=r(5317),i=r(4993),s=r(2993),a=r(4458),c=r(6034),u=r(3697),d=r(2854),{spawnedKill:p,spawnedCancel:l,setupTimeout:m,validateTimeout:f,setExitHandler:h}=r(4983),{handleInput:g,getSpawnedResult:v,makeAllStream:y,validateInputSync:S}=r(2463),{mergePromise:b,getSpawnedPromise:x}=r(8698),{joinCommand:w,parseCommand:P,getEscapedCommand:O}=r(1882),_=(e,t,r={})=>{const o=i._parse(e,t,r);return e=o.command,t=o.args,(r={maxBuffer:1e8,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:(r=o.options).cwd||process.cwd(),execPath:process.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...r}).env=(({env:e,extendEnv:t,preferLocal:r,localDir:n,execPath:o})=>{const i=t?{...process.env,...e}:e;return r?a.env({env:i,cwd:n,execPath:o}):i})(r),r.stdio=d(r),"win32"===process.platform&&"cmd"===n.basename(e,".exe")&&t.unshift("/q"),{file:e,args:t,options:r,parsed:o}},C=(e,t,r)=>"string"==typeof t||Buffer.isBuffer(t)?e.stripFinalNewline?s(t):t:void 0===r?void 0:"",I=(e,t,r)=>{const n=_(e,t,r),i=w(e,t),s=O(e,t);let a;f(n.options);try{a=o.spawn(n.file,n.args,n.options)}catch(e){const t=new o.ChildProcess,r=Promise.reject(u({error:e,stdout:"",stderr:"",all:"",command:i,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return b(t,r)}const d=x(a),S=m(a,n.options,d),P=h(a,n.options,S),I={isCanceled:!1};a.kill=p.bind(null,a.kill.bind(a)),a.cancel=l.bind(null,a,I);const T=c((async()=>{const[{error:e,exitCode:t,signal:r,timedOut:o},c,d,p]=await v(a,n.options,P),l=C(n.options,c),m=C(n.options,d),f=C(n.options,p);if(e||0!==t||null!==r){const c=u({error:e,exitCode:t,signal:r,stdout:l,stderr:m,all:f,command:i,escapedCommand:s,parsed:n,timedOut:o,isCanceled:I.isCanceled,killed:a.killed});if(!n.options.reject)return c;throw c}return{command:i,escapedCommand:s,exitCode:0,stdout:l,stderr:m,all:f,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}}));return g(a,n.options.input),a.all=y(a,n.options),b(a,T)};e.exports=I,e.exports.sync=(e,t,r)=>{const n=_(e,t,r),i=w(e,t),s=O(e,t);let a;S(n.options);try{a=o.spawnSync(n.file,n.args,n.options)}catch(e){throw u({error:e,stdout:"",stderr:"",all:"",command:i,escapedCommand:s,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}const c=C(n.options,a.stdout,a.error),d=C(n.options,a.stderr,a.error);if(a.error||0!==a.status||null!==a.signal){const e=u({stdout:c,stderr:d,error:a.error,signal:a.signal,exitCode:a.status,command:i,escapedCommand:s,parsed:n,timedOut:a.error&&"ETIMEDOUT"===a.error.code,isCanceled:!1,killed:null!==a.signal});if(!n.options.reject)return e;throw e}return{command:i,escapedCommand:s,exitCode:0,stdout:c,stderr:d,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}},e.exports.command=(e,t)=>{const[r,...n]=P(e);return I(r,n,t)},e.exports.commandSync=(e,t)=>{const[r,...n]=P(e);return I.sync(r,n,t)},e.exports.node=(e,t,r={})=>{t&&!Array.isArray(t)&&"object"==typeof t&&(r=t,t=[]);const n=d.node(r),o=process.execArgv.filter((e=>!e.startsWith("--inspect"))),{nodePath:i=process.execPath,nodeOptions:s=o}=r;return I(i,[...s,e,...Array.isArray(t)?t:[]],{...r,stdin:void 0,stdout:void 0,stderr:void 0,stdio:n,shell:!1})}},1882:e=>{"use strict";const t=(e,t=[])=>Array.isArray(t)?[e,...t]:[e],r=/^[\w.-]+$/,n=/"/g,o=/ +/g;e.exports={joinCommand:(e,r)=>t(e,r).join(" "),getEscapedCommand:(e,o)=>t(e,o).map((e=>(e=>"string"!=typeof e||r.test(e)?e:`"${e.replace(n,'\\"')}"`)(e))).join(" "),parseCommand:e=>{const t=[];for(const r of e.trim().split(o)){const e=t[t.length-1];e&&e.endsWith("\\")?t[t.length-1]=`${e.slice(0,-1)} ${r}`:t.push(r)}return t}}},3697:(e,t,r)=>{"use strict";const{signalsByName:n}=r(2751);e.exports=({stdout:e,stderr:t,all:r,error:o,signal:i,exitCode:s,command:a,escapedCommand:c,timedOut:u,isCanceled:d,killed:p,parsed:{options:{timeout:l}}})=>{s=null===s?void 0:s;const m=void 0===(i=null===i?void 0:i)?void 0:n[i].description,f=(({timedOut:e,timeout:t,errorCode:r,signal:n,signalDescription:o,exitCode:i,isCanceled:s})=>e?`timed out after ${t} milliseconds`:s?"was canceled":void 0!==r?`failed with ${r}`:void 0!==n?`was killed with ${n} (${o})`:void 0!==i?`failed with exit code ${i}`:"failed")({timedOut:u,timeout:l,errorCode:o&&o.code,signal:i,signalDescription:m,exitCode:s,isCanceled:d}),h=`Command ${f}: ${a}`,g="[object Error]"===Object.prototype.toString.call(o),v=g?`${h}\n${o.message}`:h,y=[v,t,e].filter(Boolean).join("\n");return g?(o.originalMessage=o.message,o.message=y):o=new Error(y),o.shortMessage=v,o.command=a,o.escapedCommand=c,o.exitCode=s,o.signal=i,o.signalDescription=m,o.stdout=e,o.stderr=t,void 0!==r&&(o.all=r),"bufferedData"in o&&delete o.bufferedData,o.failed=!0,o.timedOut=Boolean(u),o.isCanceled=d,o.killed=p&&!u,o}},4983:(e,t,r)=>{"use strict";const n=r(857),o=r(6270),i=(e,t,r,n)=>{if(!s(t,r,n))return;const o=c(r),i=setTimeout((()=>{e("SIGKILL")}),o);i.unref&&i.unref()},s=(e,{forceKillAfterTimeout:t},r)=>a(e)&&!1!==t&&r,a=e=>e===n.constants.signals.SIGTERM||"string"==typeof e&&"SIGTERM"===e.toUpperCase(),c=({forceKillAfterTimeout:e=!0})=>{if(!0===e)return 5e3;if(!Number.isFinite(e)||e<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`);return e};e.exports={spawnedKill:(e,t="SIGTERM",r={})=>{const n=e(t);return i(e,t,r,n),n},spawnedCancel:(e,t)=>{e.kill()&&(t.isCanceled=!0)},setupTimeout:(e,{timeout:t,killSignal:r="SIGTERM"},n)=>{if(0===t||void 0===t)return n;let o;const i=new Promise(((n,i)=>{o=setTimeout((()=>{((e,t,r)=>{e.kill(t),r(Object.assign(new Error("Timed out"),{timedOut:!0,signal:t}))})(e,r,i)}),t)})),s=n.finally((()=>{clearTimeout(o)}));return Promise.race([i,s])},validateTimeout:({timeout:e})=>{if(void 0!==e&&(!Number.isFinite(e)||e<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${e}\` (${typeof e})`)},setExitHandler:async(e,{cleanup:t,detached:r},n)=>{if(!t||r)return n;const i=o((()=>{e.kill()}));return n.finally((()=>{i()}))}}},8698:e=>{"use strict";const t=(async()=>{})().constructor.prototype,r=["then","catch","finally"].map((e=>[e,Reflect.getOwnPropertyDescriptor(t,e)]));e.exports={mergePromise:(e,t)=>{for(const[n,o]of r){const r="function"==typeof t?(...e)=>Reflect.apply(o.value,t(),e):o.value.bind(t);Reflect.defineProperty(e,n,{...o,value:r})}return e},getSpawnedPromise:e=>new Promise(((t,r)=>{e.on("exit",((e,r)=>{t({exitCode:e,signal:r})})),e.on("error",(e=>{r(e)})),e.stdin&&e.stdin.on("error",(e=>{r(e)}))}))}},2854:e=>{"use strict";const t=["stdin","stdout","stderr"],r=e=>{if(!e)return;const{stdio:r}=e;if(void 0===r)return t.map((t=>e[t]));if((e=>t.some((t=>void 0!==e[t])))(e))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${t.map((e=>`\`${e}\``)).join(", ")}`);if("string"==typeof r)return r;if(!Array.isArray(r))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof r}\``);const n=Math.max(r.length,t.length);return Array.from({length:n},((e,t)=>r[t]))};e.exports=r,e.exports.node=e=>{const t=r(e);return"ipc"===t?"ipc":void 0===t||"string"==typeof t?[t,t,t,"ipc"]:t.includes("ipc")?t:[...t,"ipc"]}},2463:(e,t,r)=>{"use strict";const n=r(1232),o=r(4594),i=r(7882),s=async(e,t)=>{if(e){e.destroy();try{return await t}catch(e){return e.bufferedData}}},a=(e,{encoding:t,buffer:r,maxBuffer:n})=>{if(e&&r)return t?o(e,{encoding:t,maxBuffer:n}):o.buffer(e,{maxBuffer:n})};e.exports={handleInput:(e,t)=>{void 0!==t&&void 0!==e.stdin&&(n(t)?t.pipe(e.stdin):e.stdin.end(t))},makeAllStream:(e,{all:t})=>{if(!t||!e.stdout&&!e.stderr)return;const r=i();return e.stdout&&r.add(e.stdout),e.stderr&&r.add(e.stderr),r},getSpawnedResult:async({stdout:e,stderr:t,all:r},{encoding:n,buffer:o,maxBuffer:i},c)=>{const u=a(e,{encoding:n,buffer:o,maxBuffer:i}),d=a(t,{encoding:n,buffer:o,maxBuffer:i}),p=a(r,{encoding:n,buffer:o,maxBuffer:2*i});try{return await Promise.all([c,u,d,p])}catch(n){return Promise.all([{error:n,signal:n.signal,timedOut:n.timedOut},s(e,u),s(t,d),s(r,p)])}},validateInputSync:({input:e})=>{if(n(e))throw new TypeError("The `input` option cannot be a stream in sync mode")}}},6270:(e,t,r)=>{var n=global.process;const o=function(e){return e&&"object"==typeof e&&"function"==typeof e.removeListener&&"function"==typeof e.emit&&"function"==typeof e.reallyExit&&"function"==typeof e.listeners&&"function"==typeof e.kill&&"number"==typeof e.pid&&"function"==typeof e.on};if(o(n)){var i,s=r(2613),a=r(651),c=/^win/i.test(n.platform),u=r(4434);"function"!=typeof u&&(u=u.EventEmitter),n.__signal_exit_emitter__?i=n.__signal_exit_emitter__:((i=n.__signal_exit_emitter__=new u).count=0,i.emitted={}),i.infinite||(i.setMaxListeners(1/0),i.infinite=!0),e.exports=function(e,t){if(!o(global.process))return function(){};s.equal(typeof e,"function","a callback must be provided for exit handler"),!1===m&&f();var r="exit";t&&t.alwaysLast&&(r="afterexit");return i.on(r,e),function(){i.removeListener(r,e),0===i.listeners("exit").length&&0===i.listeners("afterexit").length&&d()}};var d=function(){m&&o(global.process)&&(m=!1,a.forEach((function(e){try{n.removeListener(e,l[e])}catch(e){}})),n.emit=v,n.reallyExit=h,i.count-=1)};e.exports.unload=d;var p=function(e,t,r){i.emitted[e]||(i.emitted[e]=!0,i.emit(e,t,r))},l={};a.forEach((function(e){l[e]=function(){o(global.process)&&(n.listeners(e).length===i.count&&(d(),p("exit",null,e),p("afterexit",null,e),c&&"SIGHUP"===e&&(e="SIGINT"),n.kill(n.pid,e)))}})),e.exports.signals=function(){return a};var m=!1,f=function(){!m&&o(global.process)&&(m=!0,i.count+=1,a=a.filter((function(e){try{return n.on(e,l[e]),!0}catch(e){return!1}})),n.emit=y,n.reallyExit=g)};e.exports.load=f;var h=n.reallyExit,g=function(e){o(global.process)&&(n.exitCode=e||0,p("exit",n.exitCode,null),p("afterexit",n.exitCode,null),h.call(n,n.exitCode))},v=n.emit,y=function(e,t){if("exit"===e&&o(global.process)){void 0!==t&&(n.exitCode=t);var r=v.apply(this,arguments);return p("exit",n.exitCode,null),p("afterexit",n.exitCode,null),r}return v.apply(this,arguments)}}else e.exports=function(){return function(){}}},651:e=>{e.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"],"win32"!==process.platform&&e.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),"linux"===process.platform&&e.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")},5635:(e,t,r)=>{"use strict";const{PassThrough:n}=r(2203);e.exports=e=>{e={...e};const{array:t}=e;let{encoding:r}=e;const o="buffer"===r;let i=!1;t?i=!(r||o):r=r||"utf8",o&&(r=null);const s=new n({objectMode:i});r&&s.setEncoding(r);let a=0;const c=[];return s.on("data",(e=>{c.push(e),i?a=c.length:a+=e.length})),s.getBufferedValue=()=>t?c:o?Buffer.concat(c,a):c.join(""),s.getBufferedLength=()=>a,s}},4594:(e,t,r)=>{"use strict";const{constants:n}=r(181),o=r(2203),{promisify:i}=r(9023),s=r(5635),a=i(o.pipeline);class c extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}}async function u(e,t){if(!e)throw new Error("Expected a stream");t={maxBuffer:1/0,...t};const{maxBuffer:r}=t,o=s(t);return await new Promise(((t,i)=>{const s=e=>{e&&o.getBufferedLength()<=n.MAX_LENGTH&&(e.bufferedData=o.getBufferedValue()),i(e)};(async()=>{try{await a(e,o),t()}catch(e){s(e)}})(),o.on("data",(()=>{o.getBufferedLength()>r&&s(new c)}))})),o.getBufferedValue()}e.exports=u,e.exports.buffer=(e,t)=>u(e,{...t,encoding:"buffer"}),e.exports.array=(e,t)=>u(e,{...t,array:!0}),e.exports.MaxBufferError=c},4417:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SIGNALS=void 0;t.SIGNALS=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}]},2751:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.signalsByNumber=t.signalsByName=void 0;var n=r(857),o=r(5089),i=r(9075);const s=function(e,{name:t,number:r,description:n,supported:o,action:i,forced:s,standard:a}){return{...e,[t]:{name:t,number:r,description:n,supported:o,action:i,forced:s,standard:a}}},a=(0,o.getSignals)().reduce(s,{});t.signalsByName=a;const c=function(e,t){const r=u(e,t);if(void 0===r)return{};const{name:n,description:o,supported:i,action:s,forced:a,standard:c}=r;return{[e]:{name:n,number:e,description:o,supported:i,action:s,forced:a,standard:c}}},u=function(e,t){const r=t.find((({name:t})=>n.constants.signals[t]===e));return void 0!==r?r:t.find((t=>t.number===e))},d=function(){const e=(0,o.getSignals)(),t=i.SIGRTMAX+1,r=Array.from({length:t},((t,r)=>c(r,e)));return Object.assign({},...r)}();t.signalsByNumber=d},9075:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SIGRTMAX=t.getRealtimeSignals=void 0;t.getRealtimeSignals=function(){const e=o-n+1;return Array.from({length:e},r)};const r=function(e,t){return{name:`SIGRT${t+1}`,number:n+t,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},n=34,o=64;t.SIGRTMAX=o},5089:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSignals=void 0;var n=r(857),o=r(4417),i=r(9075);t.getSignals=function(){const e=(0,i.getRealtimeSignals)();return[...o.SIGNALS,...e].map(s)};const s=function({name:e,number:t,description:r,action:o,forced:i=!1,standard:s}){const{signals:{[e]:a}}=n.constants,c=void 0!==a;return{name:e,number:c?a:t,description:r,supported:c,action:o,forced:i,standard:s}}},1232:e=>{"use strict";const t=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;t.writable=e=>t(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,t.readable=e=>t(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,t.duplex=e=>t.writable(e)&&t.readable(e),t.transform=e=>t.duplex(e)&&"function"==typeof e._transform,e.exports=t},1147:(e,t,r)=>{var n;r(9896);function o(e,t,r){if("function"==typeof t&&(r=t,t={}),!r){if("function"!=typeof Promise)throw new TypeError("callback not provided");return new Promise((function(r,n){o(e,t||{},(function(e,t){e?n(e):r(t)}))}))}n(e,t||{},(function(e,n){e&&("EACCES"===e.code||t&&t.ignoreErrors)&&(e=null,n=!1),r(e,n)}))}n="win32"===process.platform||global.TESTING_WINDOWS?r(438):r(96),e.exports=o,o.sync=function(e,t){try{return n.sync(e,t||{})}catch(e){if(t&&t.ignoreErrors||"EACCES"===e.code)return!1;throw e}}},96:(e,t,r)=>{e.exports=o,o.sync=function(e,t){return i(n.statSync(e),t)};var n=r(9896);function o(e,t,r){n.stat(e,(function(e,n){r(e,!e&&i(n,t))}))}function i(e,t){return e.isFile()&&function(e,t){var r=e.mode,n=e.uid,o=e.gid,i=void 0!==t.uid?t.uid:process.getuid&&process.getuid(),s=void 0!==t.gid?t.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),d=a|c;return r&u||r&c&&o===s||r&a&&n===i||r&d&&0===i}(e,t)}},438:(e,t,r)=>{e.exports=i,i.sync=function(e,t){return o(n.statSync(e),e,t)};var n=r(9896);function o(e,t,r){return!(!e.isSymbolicLink()&&!e.isFile())&&function(e,t){var r=void 0!==t.pathExt?t.pathExt:process.env.PATHEXT;if(!r)return!0;if(-1!==(r=r.split(";")).indexOf(""))return!0;for(var n=0;n<r.length;n++){var o=r[n].toLowerCase();if(o&&e.substr(-o.length).toLowerCase()===o)return!0}return!1}(t,r)}function i(e,t,r){n.stat(e,(function(n,i){r(n,!n&&o(i,e,t))}))}},5580:(e,t,r)=>{var n=r(6110)(r(9325),"DataView");e.exports=n},1549:(e,t,r)=>{var n=r(2032),o=r(3862),i=r(6721),s=r(2749),a=r(5749);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},79:(e,t,r)=>{var n=r(3702),o=r(80),i=r(4739),s=r(8655),a=r(1175);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},8223:(e,t,r)=>{var n=r(6110)(r(9325),"Map");e.exports=n},3661:(e,t,r)=>{var n=r(3040),o=r(7670),i=r(289),s=r(4509),a=r(2949);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=s,c.prototype.set=a,e.exports=c},2804:(e,t,r)=>{var n=r(6110)(r(9325),"Promise");e.exports=n},6545:(e,t,r)=>{var n=r(6110)(r(9325),"Set");e.exports=n},8859:(e,t,r)=>{var n=r(3661),o=r(1380),i=r(1459);function s(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}s.prototype.add=s.prototype.push=o,s.prototype.has=i,e.exports=s},7217:(e,t,r)=>{var n=r(79),o=r(1420),i=r(938),s=r(3605),a=r(9817),c=r(945);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=s,u.prototype.has=a,u.prototype.set=c,e.exports=u},1873:(e,t,r)=>{var n=r(9325).Symbol;e.exports=n},7828:(e,t,r)=>{var n=r(9325).Uint8Array;e.exports=n},8303:(e,t,r)=>{var n=r(6110)(r(9325),"WeakMap");e.exports=n},9770:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var s=e[r];t(s,r,e)&&(i[o++]=s)}return i}},695:(e,t,r)=>{var n=r(8096),o=r(2428),i=r(6449),s=r(3656),a=r(361),c=r(7167),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),d=!r&&o(e),p=!r&&!d&&s(e),l=!r&&!d&&!p&&c(e),m=r||d||p||l,f=m?n(e.length,String):[],h=f.length;for(var g in e)!t&&!u.call(e,g)||m&&("length"==g||p&&("offset"==g||"parent"==g)||l&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||a(g,h))||f.push(g);return f}},4932:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},4528:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},4248:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},6025:(e,t,r)=>{var n=r(5288);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},909:(e,t,r)=>{var n=r(641),o=r(8329)(n);e.exports=o},6649:(e,t,r)=>{var n=r(3221)();e.exports=n},641:(e,t,r)=>{var n=r(6649),o=r(5950);e.exports=function(e,t){return e&&n(e,t,o)}},7422:(e,t,r)=>{var n=r(1769),o=r(7797);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[o(t[r++])];return r&&r==i?e:void 0}},2199:(e,t,r)=>{var n=r(4528),o=r(6449);e.exports=function(e,t,r){var i=t(e);return o(e)?i:n(i,r(e))}},2552:(e,t,r)=>{var n=r(1873),o=r(659),i=r(9350),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?o(e):i(e)}},8077:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},7534:(e,t,r)=>{var n=r(2552),o=r(346);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},270:(e,t,r)=>{var n=r(7068),o=r(346);e.exports=function e(t,r,i,s,a){return t===r||(null==t||null==r||!o(t)&&!o(r)?t!=t&&r!=r:n(t,r,i,s,e,a))}},7068:(e,t,r)=>{var n=r(7217),o=r(5911),i=r(1986),s=r(689),a=r(5861),c=r(6449),u=r(3656),d=r(7167),p="[object Arguments]",l="[object Array]",m="[object Object]",f=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,h,g,v){var y=c(e),S=c(t),b=y?l:a(e),x=S?l:a(t),w=(b=b==p?m:b)==m,P=(x=x==p?m:x)==m,O=b==x;if(O&&u(e)){if(!u(t))return!1;y=!0,w=!1}if(O&&!w)return v||(v=new n),y||d(e)?o(e,t,r,h,g,v):i(e,t,b,r,h,g,v);if(!(1&r)){var _=w&&f.call(e,"__wrapped__"),C=P&&f.call(t,"__wrapped__");if(_||C){var I=_?e.value():e,T=C?t.value():t;return v||(v=new n),g(I,T,r,h,v)}}return!!O&&(v||(v=new n),s(e,t,r,h,g,v))}},1799:(e,t,r)=>{var n=r(7217),o=r(270);e.exports=function(e,t,r,i){var s=r.length,a=s,c=!i;if(null==e)return!a;for(e=Object(e);s--;){var u=r[s];if(c&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++s<a;){var d=(u=r[s])[0],p=e[d],l=u[1];if(c&&u[2]){if(void 0===p&&!(d in e))return!1}else{var m=new n;if(i)var f=i(p,l,d,e,t,m);if(!(void 0===f?o(l,p,3,i,m):f))return!1}}return!0}},5083:(e,t,r)=>{var n=r(9501),o=r(7296),i=r(3805),s=r(7473),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,d=c.toString,p=u.hasOwnProperty,l=RegExp("^"+d.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?l:a).test(s(e))}},4901:(e,t,r)=>{var n=r(2552),o=r(294),i=r(346),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!s[n(e)]}},5389:(e,t,r)=>{var n=r(3663),o=r(7978),i=r(3488),s=r(6449),a=r(583);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?s(e)?o(e[0],e[1]):n(e):a(e)}},8984:(e,t,r)=>{var n=r(5527),o=r(3650),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},5128:(e,t,r)=>{var n=r(909),o=r(4894);e.exports=function(e,t){var r=-1,i=o(e)?Array(e.length):[];return n(e,(function(e,n,o){i[++r]=t(e,n,o)})),i}},3663:(e,t,r)=>{var n=r(1799),o=r(776),i=r(7197);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},7978:(e,t,r)=>{var n=r(270),o=r(8156),i=r(631),s=r(8586),a=r(756),c=r(7197),u=r(7797);e.exports=function(e,t){return s(e)&&a(t)?c(u(e),t):function(r){var s=o(r,e);return void 0===s&&s===t?i(r,e):n(t,s,3)}}},6155:(e,t,r)=>{var n=r(4932),o=r(7422),i=r(5389),s=r(5128),a=r(3937),c=r(7301),u=r(3714),d=r(3488),p=r(6449);e.exports=function(e,t,r){t=t.length?n(t,(function(e){return p(e)?function(t){return o(t,1===e.length?e[0]:e)}:e})):[d];var l=-1;t=n(t,c(i));var m=s(e,(function(e,r,o){return{criteria:n(t,(function(t){return t(e)})),index:++l,value:e}}));return a(m,(function(e,t){return u(e,t,r)}))}},7237:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},7255:(e,t,r)=>{var n=r(7422);e.exports=function(e){return function(t){return n(t,e)}}},3937:e=>{e.exports=function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}},8096:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},7556:(e,t,r)=>{var n=r(1873),o=r(4932),i=r(6449),s=r(4394),a=n?n.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(s(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},7301:e=>{e.exports=function(e){return function(t){return e(t)}}},9219:e=>{e.exports=function(e,t){return e.has(t)}},1769:(e,t,r)=>{var n=r(6449),o=r(8586),i=r(1802),s=r(3222);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:i(s(e))}},3730:(e,t,r)=>{var n=r(4394);e.exports=function(e,t){if(e!==t){var r=void 0!==e,o=null===e,i=e==e,s=n(e),a=void 0!==t,c=null===t,u=t==t,d=n(t);if(!c&&!d&&!s&&e>t||s&&a&&u&&!c&&!d||o&&a&&u||!r&&u||!i)return 1;if(!o&&!s&&!d&&e<t||d&&r&&i&&!o&&!s||c&&r&&i||!a&&i||!u)return-1}return 0}},3714:(e,t,r)=>{var n=r(3730);e.exports=function(e,t,r){for(var o=-1,i=e.criteria,s=t.criteria,a=i.length,c=r.length;++o<a;){var u=n(i[o],s[o]);if(u)return o>=c?u:u*("desc"==r[o]?-1:1)}return e.index-t.index}},5481:(e,t,r)=>{var n=r(9325)["__core-js_shared__"];e.exports=n},8329:(e,t,r)=>{var n=r(4894);e.exports=function(e,t){return function(r,o){if(null==r)return r;if(!n(r))return e(r,o);for(var i=r.length,s=t?i:-1,a=Object(r);(t?s--:++s<i)&&!1!==o(a[s],s,a););return r}}},3221:e=>{e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),s=n(t),a=s.length;a--;){var c=s[e?a:++o];if(!1===r(i[c],c,i))break}return t}}},5911:(e,t,r)=>{var n=r(8859),o=r(4248),i=r(9219);e.exports=function(e,t,r,s,a,c){var u=1&r,d=e.length,p=t.length;if(d!=p&&!(u&&p>d))return!1;var l=c.get(e),m=c.get(t);if(l&&m)return l==t&&m==e;var f=-1,h=!0,g=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++f<d;){var v=e[f],y=t[f];if(s)var S=u?s(y,v,f,t,e,c):s(v,y,f,e,t,c);if(void 0!==S){if(S)continue;h=!1;break}if(g){if(!o(t,(function(e,t){if(!i(g,t)&&(v===e||a(v,e,r,s,c)))return g.push(t)}))){h=!1;break}}else if(v!==y&&!a(v,y,r,s,c)){h=!1;break}}return c.delete(e),c.delete(t),h}},1986:(e,t,r)=>{var n=r(1873),o=r(7828),i=r(5288),s=r(5911),a=r(317),c=r(4247),u=n?n.prototype:void 0,d=u?u.valueOf:void 0;e.exports=function(e,t,r,n,u,p,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!p(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var m=a;case"[object Set]":var f=1&n;if(m||(m=c),e.size!=t.size&&!f)return!1;var h=l.get(e);if(h)return h==t;n|=2,l.set(e,t);var g=s(m(e),m(t),n,u,p,l);return l.delete(e),g;case"[object Symbol]":if(d)return d.call(e)==d.call(t)}return!1}},689:(e,t,r)=>{var n=r(2),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,s,a){var c=1&r,u=n(e),d=u.length;if(d!=n(t).length&&!c)return!1;for(var p=d;p--;){var l=u[p];if(!(c?l in t:o.call(t,l)))return!1}var m=a.get(e),f=a.get(t);if(m&&f)return m==t&&f==e;var h=!0;a.set(e,t),a.set(t,e);for(var g=c;++p<d;){var v=e[l=u[p]],y=t[l];if(i)var S=c?i(y,v,l,t,e,a):i(v,y,l,e,t,a);if(!(void 0===S?v===y||s(v,y,r,i,a):S)){h=!1;break}g||(g="constructor"==l)}if(h&&!g){var b=e.constructor,x=t.constructor;b==x||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x||(h=!1)}return a.delete(e),a.delete(t),h}},4840:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},2:(e,t,r)=>{var n=r(2199),o=r(4664),i=r(5950);e.exports=function(e){return n(e,i,o)}},2651:(e,t,r)=>{var n=r(4218);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},776:(e,t,r)=>{var n=r(756),o=r(5950);e.exports=function(e){for(var t=o(e),r=t.length;r--;){var i=t[r],s=e[i];t[r]=[i,s,n(s)]}return t}},6110:(e,t,r)=>{var n=r(5083),o=r(392);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},659:(e,t,r)=>{var n=r(1873),o=Object.prototype,i=o.hasOwnProperty,s=o.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var o=s.call(e);return n&&(t?e[a]=r:delete e[a]),o}},4664:(e,t,r)=>{var n=r(9770),o=r(3345),i=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),n(s(e),(function(t){return i.call(e,t)})))}:o;e.exports=a},5861:(e,t,r)=>{var n=r(5580),o=r(8223),i=r(2804),s=r(6545),a=r(8303),c=r(2552),u=r(7473),d="[object Map]",p="[object Promise]",l="[object Set]",m="[object WeakMap]",f="[object DataView]",h=u(n),g=u(o),v=u(i),y=u(s),S=u(a),b=c;(n&&b(new n(new ArrayBuffer(1)))!=f||o&&b(new o)!=d||i&&b(i.resolve())!=p||s&&b(new s)!=l||a&&b(new a)!=m)&&(b=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case h:return f;case g:return d;case v:return p;case y:return l;case S:return m}return t}),e.exports=b},392:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},9326:(e,t,r)=>{var n=r(1769),o=r(2428),i=r(6449),s=r(361),a=r(294),c=r(7797);e.exports=function(e,t,r){for(var u=-1,d=(t=n(t,e)).length,p=!1;++u<d;){var l=c(t[u]);if(!(p=null!=e&&r(e,l)))break;e=e[l]}return p||++u!=d?p:!!(d=null==e?0:e.length)&&a(d)&&s(l,d)&&(i(e)||o(e))}},2032:(e,t,r)=>{var n=r(1042);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},3862:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},6721:(e,t,r)=>{var n=r(1042),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},2749:(e,t,r)=>{var n=r(1042),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},5749:(e,t,r)=>{var n=r(1042);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},361:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},8586:(e,t,r)=>{var n=r(6449),o=r(4394),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||(s.test(e)||!i.test(e)||null!=t&&e in Object(t))}},4218:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},7296:(e,t,r)=>{var n,o=r(5481),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},5527:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},756:(e,t,r)=>{var n=r(3805);e.exports=function(e){return e==e&&!n(e)}},3702:e=>{e.exports=function(){this.__data__=[],this.size=0}},80:(e,t,r)=>{var n=r(6025),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},4739:(e,t,r)=>{var n=r(6025);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},8655:(e,t,r)=>{var n=r(6025);e.exports=function(e){return n(this.__data__,e)>-1}},1175:(e,t,r)=>{var n=r(6025);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},3040:(e,t,r)=>{var n=r(1549),o=r(79),i=r(8223);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},7670:(e,t,r)=>{var n=r(2651);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},289:(e,t,r)=>{var n=r(2651);e.exports=function(e){return n(this,e).get(e)}},4509:(e,t,r)=>{var n=r(2651);e.exports=function(e){return n(this,e).has(e)}},2949:(e,t,r)=>{var n=r(2651);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},317:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},7197:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},2224:(e,t,r)=>{var n=r(104);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},1042:(e,t,r)=>{var n=r(6110)(Object,"create");e.exports=n},3650:(e,t,r)=>{var n=r(4335)(Object.keys,Object);e.exports=n},6009:(e,t,r)=>{e=r.nmd(e);var n=r(4840),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,s=i&&i.exports===o&&n.process,a=function(){try{var e=i&&i.require&&i.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a},9350:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},4335:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},9325:(e,t,r)=>{var n=r(4840),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},1380:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},1459:e=>{e.exports=function(e){return this.__data__.has(e)}},4247:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},1420:(e,t,r)=>{var n=r(79);e.exports=function(){this.__data__=new n,this.size=0}},938:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},3605:e=>{e.exports=function(e){return this.__data__.get(e)}},9817:e=>{e.exports=function(e){return this.__data__.has(e)}},945:(e,t,r)=>{var n=r(79),o=r(8223),i=r(3661);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var s=r.__data__;if(!o||s.length<199)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(s)}return r.set(e,t),this.size=r.size,this}},1802:(e,t,r)=>{var n=r(2224),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,s=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,r,n,o){t.push(n?o.replace(i,"$1"):r||e)})),t}));e.exports=s},7797:(e,t,r)=>{var n=r(4394);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},7473:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},5288:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},8156:(e,t,r)=>{var n=r(7422);e.exports=function(e,t,r){var o=null==e?void 0:n(e,t);return void 0===o?r:o}},631:(e,t,r)=>{var n=r(8077),o=r(9326);e.exports=function(e,t){return null!=e&&o(e,t,n)}},3488:e=>{e.exports=function(e){return e}},2428:(e,t,r)=>{var n=r(7534),o=r(346),i=Object.prototype,s=i.hasOwnProperty,a=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return o(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},6449:e=>{var t=Array.isArray;e.exports=t},4894:(e,t,r)=>{var n=r(9501),o=r(294);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},3656:(e,t,r)=>{e=r.nmd(e);var n=r(9325),o=r(9935),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,a=s&&s.exports===i?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||o;e.exports=c},9501:(e,t,r)=>{var n=r(2552),o=r(3805);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},294:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},3805:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},346:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},4394:(e,t,r)=>{var n=r(2552),o=r(346);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},7167:(e,t,r)=>{var n=r(4901),o=r(7301),i=r(6009),s=i&&i.isTypedArray,a=s?o(s):n;e.exports=a},5950:(e,t,r)=>{var n=r(695),o=r(8984),i=r(4894);e.exports=function(e){return i(e)?n(e):o(e)}},104:(e,t,r)=>{var n=r(3661);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=e.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(o.Cache||n),r}o.Cache=n,e.exports=o},2877:(e,t,r)=>{var n=r(6155),o=r(6449);e.exports=function(e,t,r,i){return null==e?[]:(o(t)||(t=null==t?[]:[t]),o(r=i?void 0:r)||(r=null==r?[]:[r]),n(e,t,r))}},583:(e,t,r)=>{var n=r(7237),o=r(7255),i=r(8586),s=r(7797);e.exports=function(e){return i(e)?n(s(e)):o(e)}},3345:e=>{e.exports=function(){return[]}},9935:e=>{e.exports=function(){return!1}},3222:(e,t,r)=>{var n=r(7556);e.exports=function(e){return null==e?"":n(e)}},7882:(e,t,r)=>{"use strict";const{PassThrough:n}=r(2203);e.exports=function(){var e=[],t=new n({objectMode:!0});return t.setMaxListeners(0),t.add=r,t.isEmpty=function(){return 0==e.length},t.on("unpipe",o),Array.prototype.slice.call(arguments).forEach(r),t;function r(n){return Array.isArray(n)?(n.forEach(r),this):(e.push(n),n.once("end",o.bind(null,n)),n.once("error",t.emit.bind(t,"error")),n.pipe(t,{end:!1}),this)}function o(r){!(e=e.filter((function(e){return e!==r}))).length&&t.readable&&t.end()}}},4865:e=>{"use strict";const t=(e,t)=>{for(const r of Reflect.ownKeys(t))Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));return e};e.exports=t,e.exports.default=t},326:(e,t,r)=>{const n=r(4434),o=r(6928),{fork:i}=r(5317),s=r(4371);e.exports=class extends n{constructor(e,t,r){super(),r||(r={scheduled:!0,recoverMissedExecutions:!1}),this.cronExpression=e,this.taskPath=t,this.options=r,this.options.name=this.options.name||s.v4(),r.scheduled&&this.start()}start(){this.stop(),this.forkProcess=i("node_modules/node-cron/src/background-scheduled-task/daemon.js"),this.forkProcess.on("message",(e=>{if("task-done"===e.type)this.emit("task-done",e.result)}));let e=this.options;e.scheduled=!0,this.forkProcess.send({type:"register",path:o.resolve(this.taskPath),cron:this.cronExpression,options:e})}stop(){this.forkProcess&&this.forkProcess.kill()}pid(){if(this.forkProcess)return this.forkProcess.pid}isRunning(){return!this.forkProcess.killed}}},3901:e=>{"use strict";e.exports=(()=>{function e(e,t){return-1!==e.indexOf("*")?e.replace("*",t):e}return function(t){return t[0]=e(t[0],"0-59"),t[1]=e(t[1],"0-59"),t[2]=e(t[2],"0-23"),t[3]=e(t[3],"1-31"),t[4]=e(t[4],"1-12"),t[5]=e(t[5],"0-6"),t}})()},2462:(e,t,r)=>{"use strict";const n=r(2370),o=r(7619),i=r(3901),s=r(8504),a=r(6802);e.exports=function(e){let t=(r=e,r.replace(/\s{2,}/g," ").trim()).split(" ");var r;return t=function(e){return 5===e.length?["0"].concat(e):e}(t),t[4]=n(t[4]),t[5]=o(t[5]),t=i(t),t=s(t),t=a(t),t=function(e){for(let t=0;t<e.length;t++){const r=e[t].split(",");for(let e=0;e<r.length;e++)r[e]=parseInt(r[e]);e[t]=r}return e}(t),t.join(" ")}},2370:e=>{"use strict";e.exports=(()=>{const e=["january","february","march","april","may","june","july","august","september","october","november","december"],t=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function r(e,t){for(let r=0;r<t.length;r++)e=e.replace(new RegExp(t[r],"gi"),parseInt(r,10)+1);return e}return function(n){return n=r(n,e),n=r(n,t)}})()},8504:e=>{"use strict";e.exports=(()=>{function e(e,t,r,n){const o=[];let i=parseInt(n),s=parseInt(r);s>i&&(i=parseInt(r),s=parseInt(n));for(let e=s;e<=i;e++)o.push(e);return e.replace(new RegExp(t,"i"),o.join())}function t(t){const r=/(\d+)-(\d+)/;let n=r.exec(t);for(;null!==n&&n.length>0;)t=e(t,n[0],n[1],n[2]),n=r.exec(t);return t}return function(e){for(let r=0;r<e.length;r++)e[r]=t(e[r]);return e}})()},6802:e=>{"use strict";e.exports=function(e){for(var t=/^(.+)\/(\w+)$/,r=0;r<e.length;r++){var n=t.exec(e[r]);if(null!==n&&n.length>0){var o=n[2];if(isNaN(o))throw o+" is not a valid step value";for(var i=n[1].split(","),s=[],a=parseInt(o,10),c=0;c<=i.length;c++){var u=parseInt(i[c],10);u%a==0&&s.push(u)}e[r]=s.join(",")}}return e}},7619:e=>{"use strict";e.exports=(()=>{const e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],t=["sun","mon","tue","wed","thu","fri","sat"];function r(e,t){for(let r=0;r<t.length;r++)e=e.replace(new RegExp(t[r],"gi"),parseInt(r,10));return e}return function(n){return n=r(n=n.replace("7","0"),e),r(n,t)}})()},8274:(e,t,r)=>{"use strict";const n=r(8758),o=r(326),i=r(499),s=r(6456);e.exports={schedule:function(e,t,r){const i=function(e,t,r){return"string"==typeof t?new o(e,t,r):new n(e,t,r)}(e,t,r);return s.save(i),i},validate:function(e){try{return i(e),!0}catch(e){return!1}},getTasks:function(){return s.getTasks()}}},499:(e,t,r)=>{"use strict";const n=r(2462),o=/^(?:\d+|\*|\*\/\d+)$/;function i(e,t,r){const n=e.split(",");for(const e of n){const n=parseInt(e,10);if(!Number.isNaN(n)&&(n<t||n>r)||!o.test(e))return!1}return!0}function s(e,t){if(!i(t[0],0,59))throw new Error(`${e[0]} is a invalid expression for second`);if(function(e){return!i(e,0,59)}(t[1]))throw new Error(`${e[1]} is a invalid expression for minute`);if(function(e){return!i(e,0,23)}(t[2]))throw new Error(`${e[2]} is a invalid expression for hour`);if(function(e){return!i(e,1,31)}(t[3]))throw new Error(`${e[3]} is a invalid expression for day of month`);if(function(e){return!i(e,1,12)}(t[4]))throw new Error(`${e[4]} is a invalid expression for month`);if(function(e){return!i(e,0,7)}(t[5]))throw new Error(`${e[5]} is a invalid expression for week day`)}e.exports=function(e){if("string"!=typeof e)throw new TypeError("pattern must be a string!");const t=e.split(" "),r=n(e).split(" ");5===t.length&&t.unshift("0"),s(t,r)}},8758:(e,t,r)=>{"use strict";const n=r(4434),o=r(5184),i=r(288),s=r(4371);e.exports=class extends n{constructor(e,t,r){super(),r||(r={scheduled:!0,recoverMissedExecutions:!1}),this.options=r,this.options.name=this.options.name||s.v4(),this._task=new o(t),this._scheduler=new i(e,r.timezone,r.recoverMissedExecutions),this._scheduler.on("scheduled-time-matched",(e=>{this.now(e)})),!1!==r.scheduled&&this._scheduler.start(),!0===r.runOnInit&&this.now("init")}now(e="manual"){let t=this._task.execute(e);this.emit("task-done",t)}start(){this._scheduler.start()}stop(){this._scheduler.stop()}}},288:(e,t,r)=>{"use strict";const n=r(4434),o=r(3979);e.exports=class extends n{constructor(e,t,r){super(),this.timeMatcher=new o(e,t),this.autorecover=r}start(){this.stop();let e=process.hrtime(),t=this.timeMatcher.apply(new Date);const r=()=>{const n=process.hrtime(e),o=(1e9*n[0]+n[1])/1e6;for(let e=Math.floor(o/1e3);e>=0;e--){const r=new Date((new Date).getTime()-1e3*e);let n=this.timeMatcher.apply(r);t.getTime()<n.getTime()&&(0===e||this.autorecover)&&this.timeMatcher.match(r)&&(this.emit("scheduled-time-matched",n),n.setMilliseconds(0),t=n)}e=process.hrtime(),this.timeout=setTimeout(r,1e3)};r()}stop(){this.timeout&&clearTimeout(this.timeout),this.timeout=null}}},6456:(e,t,r)=>{e.exports=(global.scheduledTasks||(global.scheduledTasks=new Map),{save:e=>{if(!e.options){const t=r(4371);e.options={},e.options.name=t.v4()}global.scheduledTasks.set(e.options.name,e)},getTasks:()=>global.scheduledTasks})},5184:(e,t,r)=>{"use strict";const n=r(4434);e.exports=class extends n{constructor(e){if(super(),"function"!=typeof e)throw"execution must be a function";this._execution=e}execute(e){let t;try{t=this._execution(e)}catch(e){return this.emit("task-failed",e)}return t instanceof Promise?t.then((()=>this.emit("task-finished"))).catch((e=>this.emit("task-failed",e))):(this.emit("task-finished"),t)}}},3979:(e,t,r)=>{const n=r(499),o=r(2462);function i(e,t){if(-1!==e.indexOf(",")){return-1!==e.split(",").indexOf(t.toString())}return e===t.toString()}e.exports=class{constructor(e,t){n(e),this.pattern=o(e),this.timezone=t,this.expressions=this.pattern.split(" "),this.dtf=this.timezone?new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hourCycle:"h23",fractionalSecondDigits:3,timeZone:this.timezone}):null}match(e){e=this.apply(e);const t=i(this.expressions[0],e.getSeconds()),r=i(this.expressions[1],e.getMinutes()),n=i(this.expressions[2],e.getHours()),o=i(this.expressions[3],e.getDate()),s=i(this.expressions[4],e.getMonth()+1),a=i(this.expressions[5],e.getDay());return t&&r&&n&&o&&s&&a}apply(e){return this.dtf?new Date(this.dtf.format(e)):e}}},4458:(e,t,r)=>{"use strict";const n=r(6928),o=r(9376),i=e=>{let t;e={cwd:process.cwd(),path:process.env[o()],execPath:process.execPath,...e};let r=n.resolve(e.cwd);const i=[];for(;t!==r;)i.push(n.join(r,"node_modules/.bin")),t=r,r=n.resolve(r,"..");const s=n.resolve(e.cwd,e.execPath,"..");return i.push(s),i.concat(e.path).join(n.delimiter)};e.exports=i,e.exports.default=i,e.exports.env=t=>{const r={...(t={env:process.env,...t}).env},n=o({env:r});return t.path=r[n],r[n]=e.exports(t),r}},6034:(e,t,r)=>{"use strict";const n=r(4865),o=new WeakMap,i=(e,t={})=>{if("function"!=typeof e)throw new TypeError("Expected a function");let r,i=0;const s=e.displayName||e.name||"<anonymous>",a=function(...n){if(o.set(a,++i),1===i)r=e.apply(this,n),e=null;else if(!0===t.throw)throw new Error(`Function \`${s}\` can only be called once`);return r};return n(a,e),o.set(a,i),a};e.exports=i,e.exports.default=i,e.exports.callCount=e=>{if(!o.has(e))throw new Error(`The given function \`${e.name}\` is not wrapped by the \`onetime\` package`);return o.get(e)}},9376:e=>{"use strict";const t=(e={})=>{const t=e.env||process.env;return"win32"!==(e.platform||process.platform)?"PATH":Object.keys(t).reverse().find((e=>"PATH"===e.toUpperCase()))||"Path"};e.exports=t,e.exports.default=t},9687:(e,t,r)=>{"use strict";const n=r(2779),o=r(6928),i=/\//g,s=/(NT_STATUS_OBJECT_NAME_NOT_FOUND|NT_STATUS_NO_SUCH_FILE)/im,a=e=>Array.isArray(e)?e.map((e=>`"${e.replace(i,"\\")}"`)).join(" "):`"${e.replace(i,"\\")}"`;e.exports=class{constructor(e){this.address=e.address,this.username=e.username||"guest",this.password=e.password,this.domain=e.domain,this.port=e.port,this.directory=e.directory,this.timeout=e.timeout,this.maxProtocol=e.maxProtocol,this.maskCmd=Boolean(e.maskCmd)}async getFile(e,t,r){return await this.execute("get",`${a(e)} "${t}"`,r)}async sendFile(e,t){const r=o.dirname(e);return await this.execute("put",[o.basename(e),t],r)}async deleteFile(e){return await this.execute("del",[e],"")}async listFiles(e,t){try{const r=`${e}*${t}`,n=await this.execute("dir",r,""),o=[];for(let r of n.split("\n"))if(r=r.toString().trim(),r.startsWith(e)){const e=r.substring(0,r.indexOf(t)+t.length);o.push(e)}return o}catch(e){if(e.message.match(s))return[];throw e}}async mkdir(e,t){return await this.execute("mkdir",[e],t)}async dir(e,t){return await this.execute("dir",[e],t)}async fileExists(e,t){try{return await this.dir(e,t),!0}catch(e){if(e.message.match(s))return!1;throw e}}async cwd(){return(await this.execute("cd","","")).match(/\s.{2}\s(.+?)/)[1]}async list(e){const t=[],r=await this.dir(e);for(const e of r.matchAll(/\s*(.+?)\s{6,}([A-Z0-9]{1,2})\s+([0-9]+)\s{2}(.+)/g))t.push({name:e[1],type:e[2],size:parseInt(e[3]),modifyTime:new Date(e[4]+"Z")});return t}getSmbClientArgs(e,t){const r=[];this.username&&r.push("-U",this.username),this.password||r.push("-N");let n=t;return Array.isArray(t)&&(n=a(t)),r.push("-c",`${e} ${n}`,this.address),this.password&&r.push("--password",this.password),this.domain&&r.push("-W",this.domain),this.directory&&r.push("-D",this.directory),this.maxProtocol&&r.push("--max-protocol",this.maxProtocol),this.port&&r.push("-p",this.port),this.timeout&&r.push("-t",this.timeout),r}async execute(e,t,r){const o=this.getSmbClientArgs(e,t),i={all:!0,cwd:r||""};try{const{all:e}=await n("smbclient",o,i);return e}catch(e){throw this.maskCmd&&(e.message=e.all,e.shortMessage=e.all),e}}async getAllShares(){try{const{stdout:e}=await n("smbtree",["-U","guest","-N"],{all:!0}),t=[];for(const r in e.split(/\r?\n/)){const e=r.split(/\t/);e.length>2&&null!==e[2].match(/^\s*$/)&&t.append(e[2].trim())}return t}catch(e){throw this.maskCmd&&(e.message=e.all,e.shortMessage=e.all),e}}}},1395:(e,t,r)=>{"use strict";const n=r(7521);e.exports=(e="")=>{const t=e.match(n);if(!t)return null;const[r,o]=t[0].replace(/#! ?/,"").split(" "),i=r.split("/").pop();return"env"===i?o:o?`${i} ${o}`:i}},7521:e=>{"use strict";e.exports=/^#!(.*)/},2993:e=>{"use strict";e.exports=e=>{const t="string"==typeof e?"\n":"\n".charCodeAt(),r="string"==typeof e?"\r":"\r".charCodeAt();return e[e.length-1]===t&&(e=e.slice(0,e.length-1)),e[e.length-1]===r&&(e=e.slice(0,e.length-1)),e}},7927:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=i(r(7562)),c=r(6117),u=s(r(8274)),d=s(r(9687)),p=s(r(9896)),l=s(r(6928)),m=s(r(2877)),f=(e,t)=>["*",...Array.from(Array(t+e).keys()).map((t=>String(t+e)))];var h;!function(e){e.Samba="Samba"}(h||(h={}));const g=[h.Samba],v=l.default.join(process.env.SCRYPTED_PLUGIN_VOLUME,"backups"),y=".zip";class S extends a.ScryptedDeviceBase{constructor(e){super(e),this.storageSettings=new c.StorageSettings(this,{pluginEnabled:{title:"Plugin enabled",type:"boolean",defaultValue:!0,immediate:!0},backupService:{title:"Backup service",type:"string",choices:g,defaultValue:g[0]},sambaAddress:{title:"Server address",group:"Samba",type:"string",hide:!0,placeholder:"//server/share"},sambaTargetDirectory:{title:"Target directory in the share",group:"Samba",type:"string",hide:!0},sambaUsername:{title:"Username",group:"Samba",type:"string",hide:!0,placeholder:"guest"},sambaPassword:{title:"Password",group:"Samba",type:"password"},sambaDomain:{title:"Domain",group:"Samba",placeholder:"WORKGROUP",type:"string",hide:!0},sambaMaxProtocol:{title:"Max protocol",group:"Samba",placeholder:"SMB3",type:"string",hide:!0},sambaMaskCmd:{title:"Mask commands",group:"Samba",type:"boolean",defaultValue:!1,hide:!0},maxBackupsLocal:{title:"Max backups to keep locally",group:"Retention",type:"number",defaultValue:7},maxBackupsCloud:{title:"Max backups to keep on cloud",group:"Retention",type:"number",defaultValue:7},filePrefix:{title:'File prefix. Should not contain the character "_"',group:"Retention",type:"string",defaultValue:"scrypted-backup"},backupNow:{title:"Execute backup",group:"Retention",type:"button",onPut:async()=>await this.executeBackup(new Date)},checkFiles:{title:"Check files",group:"Retention",type:"button"},dayOfWeek:{title:"Day in the week",group:"Scheduler",type:"string",choices:f(1,7),defaultValue:"*"},month:{title:"Month",group:"Scheduler",type:"string",choices:f(1,12),defaultValue:"*"},dayOfMonth:{title:"Day in the month",type:"string",group:"Scheduler",choices:f(1,31),defaultValue:"*"},hour:{title:"Hour",group:"Scheduler",type:"string",choices:f(0,23),defaultValue:"4"},minute:{title:"Minute",group:"Scheduler",type:"string",choices:f(0,59),defaultValue:"0"},second:{title:"Second",group:"Scheduler",type:"string",choices:f(0,59),defaultValue:"*"}});["second","minute","hour","dayOfWeek","month","dayOfMonth","pluginEnabled"].forEach((e=>this.storageSettings.settings[e].onPut=async()=>this.initScheduler())),this.storageSettings.settings.checkFiles.onPut=async()=>await this.checkMaxFiles(),this.initScheduler().then().catch(console.log)}async getSettings(){this.storageSettings.getItem("backupService")===h.Samba&&(this.storageSettings.settings.sambaAddress.hide=!1,this.storageSettings.settings.sambaTargetDirectory.hide=!1,this.storageSettings.settings.sambaUsername.hide=!1,this.storageSettings.settings.sambaPassword.hide=!1,this.storageSettings.settings.sambaDomain.hide=!1,this.storageSettings.settings.sambaMaskCmd.hide=!1);return await this.storageSettings.getSettings()}putSetting(e,t){return this.storageSettings.putSetting(e,t)}async initScheduler(){try{if(this.cronTask&&(this.console.log("Stopping scheduler"),this.cronTask.stop(),this.cronTask=void 0),!this.storageSettings.getItem("pluginEnabled"))return void this.console.log("Plugin is disabled");const e=this.storageSettings.getItem("second")||"*",t=this.storageSettings.getItem("minute")||"*",r=this.storageSettings.getItem("hour")||"*",n=this.storageSettings.getItem("dayOfMonth")||"*",o=this.storageSettings.getItem("month")||"*",i=`${e} ${t} ${r} ${n} ${o} ${this.storageSettings.getItem("dayOfWeek")||"*"}`;this.console.log(`Starting scheduler with ${i}`),this.cronTask=u.default.schedule(i,(async()=>{try{const e=new Date;this.console.log(`Executing scheduled backup at ${e.toLocaleString()}`),await this.executeBackup(e),await this.checkMaxFiles()}catch(e){this.console.log("Error executing the scheduled backup: ",e)}}))}catch(e){this.console.log("Error in initScheduler",e)}}getFileNames(e){const t=`${this.storageSettings.getItem("filePrefix")||"scrypted-backup"}-${`${e.getFullYear()}_${e.getMonth()+1}_${e.getDate()}_${e.getHours()}_${e.getMinutes()}_${e.getSeconds()}`}${y}`;return{fileName:t,filePath:`${v}/${t}`}}async downloadBackup(e){this.console.log("Starting backup download ");try{const t=await a.default.systemManager.getComponent("backup"),r=await t.createBackup(),n=(1e-6*r.length).toFixed(1);console.log(`Downloaded successfull. File size: ${n} mb.`),p.default.existsSync(v)||(this.console.log(`Creating backups dir at: ${v}`),p.default.mkdirSync(v));const{filePath:o,fileName:i}=this.getFileNames(e);return await p.default.promises.writeFile(o,r),{filePath:o,fileName:i}}catch(e){return void this.console.log("Error downloading backup",e)}}async executeBackup(e){const t=this.storageSettings.getItem("backupService"),{fileName:r,filePath:n}=await this.downloadBackup(e);t===h.Samba&&(this.console.log("Check the readme in Samba section to check how to install the samba client"),await this.executeBackupSamba(r,n))}async getSambaClient(){const e=this.storageSettings.getItem("sambaAddress"),t=this.storageSettings.getItem("sambaUsername"),r=this.storageSettings.getItem("sambaPassword"),n=this.storageSettings.getItem("sambaDomain"),o=this.storageSettings.getItem("sambaMaxProtocol"),i=this.storageSettings.getItem("sambaMaskCmd"),s=this.storageSettings.getItem("sambaTargetDirectory");if(!e)return void this.console.log("Address and targetDirectory are required");let a;try{a=new d.default({address:e,username:t,password:r,domain:n,maxProtocol:o,maskCmd:i,directory:s})}catch(e){return void this.console.log("Error during Samba connection",e)}return a}async executeBackupSamba(e,t){const r=await this.getSambaClient(),n=e;this.console.log(`Uploading file to SMB. Source path is ${t}, destination is :${n}`);try{await r.sendFile(t,n)}catch(e){this.console.log("Error uploading backup to SMB",e)}this.console.log("Upload to SMB completed.")}async checkMaxFiles(){this.storageSettings.getItem("backupService")===h.Samba&&await this.checkSambaMaxFiles(),await this.checkLocalMaxFiles()}parseFiles(e,t){const r=this.storageSettings.getItem("filePrefix"),n={};for(const t of e){const e=t.split(r)[1].replace(y,"").replace("-",""),[o,i,s,a,c,u]=e.split("_"),d=new Date;d.setFullYear(Number(o)),d.setMonth(Number(i)),d.setDate(Number(s)),d.setHours(Number(a)),d.setMinutes(Number(c)),d.setSeconds(Number(u)),d.setMilliseconds(0),n[t]=d.getTime()}const o=(0,m.default)(e,(e=>n[e]),"asc"),i=o.length-t;return o.splice(0,i)}async checkSambaMaxFiles(){this.console.log("Starting Samba cleanup");const e=this.storageSettings.getItem("maxBackupsCloud"),t=await this.getSambaClient(),r=this.storageSettings.getItem("filePrefix"),n=await t.listFiles(r,y),o=this.parseFiles(n,e),i=o.length;if(i>0){this.console.log(`Removing ${i} old backups`);for(const e of o)try{await t.deleteFile(e),this.console.log(`File ${e} removed`)}catch(t){this.console.log(`Error removing file ${e}`,t)}this.console.log("Samba cleanup completed")}else this.console.log("Nothing to cleanup on Samba")}async checkLocalMaxFiles(){this.console.log("Starting Local cleanup");const e=this.storageSettings.getItem("maxBackupsLocal"),t=this.storageSettings.getItem("filePrefix"),r=(await p.default.promises.readdir(v)).filter((e=>e.startsWith(t))),n=this.parseFiles(r,e),o=n.length;if(o>0){this.console.log(`Removing ${o} old backups`);for(const e of n)try{await p.default.promises.unlink(`${v}/${e}`),this.console.log(`File ${e} removed`)}catch(t){this.console.log(`Error removing file ${e}`,t)}this.console.log("Samba cleanup completed")}else this.console.log("Nothing to cleanup on local")}}t.default=S},4371:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NIL:()=>w,parse:()=>v,stringify:()=>p,v1:()=>g,v3:()=>S,v4:()=>b,v5:()=>x,validate:()=>u,version:()=>P});const n=require("crypto");var o=r.n(n);const i=new Uint8Array(256);let s=i.length;function a(){return s>i.length-16&&(o().randomFillSync(i),s=0),i.slice(s,s+=16)}const c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const u=function(e){return"string"==typeof e&&c.test(e)},d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).substr(1));const p=function(e,t=0){const r=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!u(r))throw TypeError("Stringified UUID is invalid");return r};let l,m,f=0,h=0;const g=function(e,t,r){let n=t&&r||0;const o=t||new Array(16);let i=(e=e||{}).node||l,s=void 0!==e.clockseq?e.clockseq:m;if(null==i||null==s){const t=e.random||(e.rng||a)();null==i&&(i=l=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=m=16383&(t[6]<<8|t[7]))}let c=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:h+1;const d=c-f+(u-h)/1e4;if(d<0&&void 0===e.clockseq&&(s=s+1&16383),(d<0||c>f)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");f=c,h=u,m=s,c+=122192928e5;const g=(1e4*(268435455&c)+u)%4294967296;o[n++]=g>>>24&255,o[n++]=g>>>16&255,o[n++]=g>>>8&255,o[n++]=255&g;const v=c/4294967296*1e4&268435455;o[n++]=v>>>8&255,o[n++]=255&v,o[n++]=v>>>24&15|16,o[n++]=v>>>16&255,o[n++]=s>>>8|128,o[n++]=255&s;for(let e=0;e<6;++e)o[n+e]=i[e];return t||p(o)};const v=function(e){if(!u(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function y(e,t,r){function n(e,n,o,i){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=v(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let s=new Uint8Array(16+e.length);if(s.set(n),s.set(e,n.length),s=r(s),s[6]=15&s[6]|t,s[8]=63&s[8]|128,o){i=i||0;for(let e=0;e<16;++e)o[i+e]=s[e];return o}return p(s)}try{n.name=e}catch(e){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}const S=y("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),o().createHash("md5").update(e).digest()}));const b=function(e,t,r){const n=(e=e||{}).random||(e.rng||a)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return p(n)};const x=y("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),o().createHash("sha1").update(e).digest()})),w="00000000-0000-0000-0000-000000000000";const P=function(e){if(!u(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},6911:(e,t,r)=>{const n="win32"===process.platform||"cygwin"===process.env.OSTYPE||"msys"===process.env.OSTYPE,o=r(6928),i=n?";":":",s=r(1147),a=e=>Object.assign(new Error(`not found: ${e}`),{code:"ENOENT"}),c=(e,t)=>{const r=t.colon||i,o=e.match(/\//)||n&&e.match(/\\/)?[""]:[...n?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(r)],s=n?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",a=n?s.split(r):[""];return n&&-1!==e.indexOf(".")&&""!==a[0]&&a.unshift(""),{pathEnv:o,pathExt:a,pathExtExe:s}},u=(e,t,r)=>{"function"==typeof t&&(r=t,t={}),t||(t={});const{pathEnv:n,pathExt:i,pathExtExe:u}=c(e,t),d=[],p=r=>new Promise(((i,s)=>{if(r===n.length)return t.all&&d.length?i(d):s(a(e));const c=n[r],u=/^".*"$/.test(c)?c.slice(1,-1):c,p=o.join(u,e),m=!u&&/^\.[\\\/]/.test(e)?e.slice(0,2)+p:p;i(l(m,r,0))})),l=(e,r,n)=>new Promise(((o,a)=>{if(n===i.length)return o(p(r+1));const c=i[n];s(e+c,{pathExt:u},((i,s)=>{if(!i&&s){if(!t.all)return o(e+c);d.push(e+c)}return o(l(e,r,n+1))}))}));return r?p(0).then((e=>r(null,e)),r):p(0)};e.exports=u,u.sync=(e,t)=>{t=t||{};const{pathEnv:r,pathExt:n,pathExtExe:i}=c(e,t),u=[];for(let a=0;a<r.length;a++){const c=r[a],d=/^".*"$/.test(c)?c.slice(1,-1):c,p=o.join(d,e),l=!d&&/^\.[\\\/]/.test(e)?e.slice(0,2)+p:p;for(let e=0;e<n.length;e++){const r=l+n[e];try{if(s.sync(r,{pathExt:i})){if(!t.all)return r;u.push(r)}}catch(e){}}}if(t.all&&u.length)return u;if(t.nothrow)return null;throw a(e)}},2613:e=>{"use strict";e.exports=require("assert")},181:e=>{"use strict";e.exports=require("buffer")},5317:e=>{"use strict";e.exports=require("child_process")},4434:e=>{"use strict";e.exports=require("events")},9896:e=>{"use strict";e.exports=require("fs")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")},2203:e=>{"use strict";e.exports=require("stream")},9023:e=>{"use strict";e.exports=require("util")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n=r(7927),o=exports="undefined"==typeof exports?{}:exports;for(var i in n)o[i]=n[i];n.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();
//# sourceMappingURL=main.nodejs.js.map